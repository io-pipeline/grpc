syntax = "proto3";

package io.pipeline.validation.v1;

import "google/protobuf/any.proto";

option java_package = "io.pipeline.validation.v1";
option java_multiple_files = true;

// Validation service for pipeline components
service ValidationService {
  rpc ValidateNode(ValidateNodeRequest) returns (ValidationResponse);
  rpc ValidateGraph(ValidateGraphRequest) returns (ValidationResponse);
  rpc ValidateModule(ValidateModuleRequest) returns (ValidationResponse);
}

message ValidateNodeRequest {
  google.protobuf.Any node = 1;
  ValidationMode mode = 2;
  string cluster_id = 3;
}

message ValidateGraphRequest {
  google.protobuf.Any graph = 1;
  ValidationMode mode = 2;
  string cluster_id = 3;
}

message ValidateModuleRequest {
  google.protobuf.Any module = 1;
  ValidationMode mode = 2;
}

message ValidationResponse {
  bool is_valid = 1;
  repeated ValidationError errors = 2;
  repeated ValidationWarning warnings = 3;
  repeated ValidationSuggestion suggestions = 4;
}

message ValidationError {
  ValidationErrorType error_type = 1;
  string field_path = 2;
  string message = 3;
  string error_code = 4;
  google.protobuf.Any context = 5;
}

message ValidationWarning {
  ValidationWarningType warning_type = 1;
  string field_path = 2;
  string message = 3;
  string warning_code = 4;
  google.protobuf.Any context = 5;
}

message ValidationSuggestion {
  string message = 1;
  string suggested_fix = 2;
  google.protobuf.Any suggested_value = 3;
}

enum ValidationMode {
  VALIDATION_MODE_UNSPECIFIED = 0;
  VALIDATION_MODE_DRAFT = 1;
  VALIDATION_MODE_DESIGN = 2;
  VALIDATION_MODE_PRODUCTION = 3;
}

enum ValidationErrorType {
  VALIDATION_ERROR_TYPE_UNSPECIFIED = 0;
  VALIDATION_ERROR_TYPE_REQUIRED_FIELD = 1;
  VALIDATION_ERROR_TYPE_INVALID_FORMAT = 2;
  VALIDATION_ERROR_TYPE_DUPLICATE_NAME = 3;
  VALIDATION_ERROR_TYPE_CIRCULAR_DEPENDENCY = 4;
  VALIDATION_ERROR_TYPE_MODULE_NOT_FOUND = 5;
  VALIDATION_ERROR_TYPE_INVALID_NODE_ID = 6;
  VALIDATION_ERROR_TYPE_CLUSTER_NOT_FOUND = 7;
  VALIDATION_ERROR_TYPE_CUSTOM = 999;
}

enum ValidationWarningType {
  VALIDATION_WARNING_TYPE_UNSPECIFIED = 0;
  VALIDATION_WARNING_TYPE_DEPRECATED = 1;
  VALIDATION_WARNING_TYPE_PERFORMANCE = 2;
  VALIDATION_WARNING_TYPE_BEST_PRACTICE = 3;
  VALIDATION_WARNING_TYPE_ORPHANED_NODE = 4;
  VALIDATION_WARNING_TYPE_CUSTOM = 999;
}