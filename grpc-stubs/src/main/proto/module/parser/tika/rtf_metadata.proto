syntax = "proto3";

package io.pipeline.parsed.data.rtf.v1;

import "google/protobuf/timestamp.proto";
import "google/protobuf/struct.proto";
import "module/parser/tika/tika_base_metadata.proto";

option java_multiple_files = true;
option java_package = "io.pipeline.parsed.data.rtf.v1";
option java_outer_classname = "RtfMetadataProto";

/**
 * Comprehensive RTF (Rich Text Format) metadata as extracted by Tika.
 * Based on Tika's RTFMetadata interface, TextExtractor, and RTFEmbObjHandler implementations.
 * This is a 1:1 mapping to all fields that Tika can extract from RTF documents.
 * 
 * RTF documents can contain rich formatting, embedded objects, and document properties
 * similar to Microsoft Office documents but in a text-based format.
 */
message RtfMetadata {
  // Dublin/Core fields are normalized at TikaResponse.dublin_core.
  // Reserve these names and field numbers to prevent reuse here.
  reserved 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11;
  reserved "title", "creator", "description", "subject", "language", "format",
           "identifier", "comments", "created", "modified", "creator_tool";
  
  // === Office-style Properties (from Office/OfficeOpenXML interfaces) ===
  optional string keywords = 12;                      // Office.KEYWORDS (from \keywords)
  optional string category = 13;                      // OfficeOpenXMLCore.CATEGORY (from \category)
  optional string company = 14;                       // OfficeOpenXMLExtended.COMPANY (from \company)
  optional string manager = 15;                       // OfficeOpenXMLExtended.MANAGER (from \manager)
  optional string template = 16;                      // OfficeOpenXMLExtended.TEMPLATE (from \template)
  
  // === Document Statistics (from Office interface) ===
  optional int32 page_count = 17;                     // Office.PAGE_COUNT (from \nofpages)
  optional int32 word_count = 18;                     // Office.WORD_COUNT (from \nofwords)
  optional int32 character_count = 19;                // Office.CHARACTER_COUNT (from \nofchars)
  
  // === RTF-Specific Properties (from RTFMetadata interface) ===
  optional bool contains_encapsulated_html = 20;      // RTFMetadata.CONTAINS_ENCAPSULATED_HTML
  optional bool thumbnail = 21;                       // RTFMetadata.THUMBNAIL (for embedded objects)
  optional string emb_app_version = 22;               // RTFMetadata.EMB_APP_VERSION
  optional string emb_class = 23;                     // RTFMetadata.EMB_CLASS
  optional string emb_topic = 24;                     // RTFMetadata.EMB_TOPIC
  optional string emb_item = 25;                      // RTFMetadata.EMB_ITEM
  
  // === Content and Resource Properties ===
  optional string content_type = 26;                  // Metadata.CONTENT_TYPE ("application/rtf")
  optional string content_encoding = 27;              // Metadata.CONTENT_ENCODING
  optional string content_length = 28;                // Metadata.CONTENT_LENGTH
  optional string resource_name = 29;                 // TikaCoreProperties.RESOURCE_NAME_KEY
  optional string original_resource_name = 30;        // TikaCoreProperties.ORIGINAL_RESOURCE_NAME
  optional string embedded_relationship_id = 31;      // TikaCoreProperties.EMBEDDED_RELATIONSHIP_ID
  
  // === Font and Formatting Properties ===
  optional int32 default_font = 32;                   // Default font number (from \deff)
  optional string font_table = 33;                    // Font table information
  optional string color_table = 34;                   // Color table information
  optional string style_sheet = 35;                   // Style sheet information
  
  // === RTF Version and Compatibility ===
  optional string rtf_version = 36;                   // RTF version (from \rtf1)
  optional string generator = 37;                     // Generator application (from \generator)
  optional string view_kind = 38;                     // View kind (from \viewkind)
  optional int32 view_scale = 39;                     // View scale (from \viewscale)
  
  // === Document Layout Properties ===
  optional int32 paper_width = 40;                    // Paper width (from \paperw)
  optional int32 paper_height = 41;                   // Paper height (from \paperh)
  optional int32 margin_left = 42;                    // Left margin (from \margl)
  optional int32 margin_right = 43;                   // Right margin (from \margr)
  optional int32 margin_top = 44;                     // Top margin (from \margt)
  optional int32 margin_bottom = 45;                  // Bottom margin (from \margb)
  
  // === Embedded Objects and Pictures ===
  repeated string embedded_resource_names = 46;       // Names of embedded resources
  repeated string picture_descriptions = 47;          // Picture descriptions (from \wzDescription)
  optional int32 embedded_object_count = 48;          // Count of embedded objects
  optional int32 picture_count = 49;                  // Count of embedded pictures
  
  // === RTF Control Properties ===
  optional bool ignore_list_markup = 50;              // Parser setting for list markup
  optional int32 memory_limit_kb = 51;                // Memory limit for embedded objects
  optional string rtf_pict_meta_prefix = 52;          // RTF picture metadata prefix
  
  // === Revision and Tracking Properties ===
  optional google.protobuf.Timestamp revision_time = 53;  // Revision time (from \revtim)
  optional google.protobuf.Timestamp print_time = 54;     // Print time (from \printim)
  optional int32 version = 55;                        // Document version (from \version)
  optional int32 revision_count = 56;                 // Number of revisions
  
  // === Security and Protection ===
  optional bool password_protected = 57;              // Document password protection
  optional string protection_type = 58;               // Type of document protection
  
  // === Catch-all for unknown/unmapped fields ===
  google.protobuf.Struct additional_metadata = 200;
  
  /**
   * Base Tika fields common to all document types
   */
  io.pipeline.parsed.data.tika.base.v1.TikaBaseFields base_fields = 201;
}
